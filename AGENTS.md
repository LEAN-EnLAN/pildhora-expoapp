# Repository Guidelines

## Project Structure & Module Organization
- Core app code lives in `app/` (Expo Router screens) and `src/` (services, Redux store, components, types).
- Backend helpers and Firebase callable logic are under `functions/`.
- Shared assets: `assets/`; configuration: `.env`, `firebase.json`, `app.json`.
- Tests reside in `tests/` (unit/integration) and `coverage/` stores reports when generated.
- Native build outputs live in `android/` and `ios/` (managed by Expo prebuild).

## Build, Test, and Development Commands
- `npm start` — launch Expo dev server (Metro) on port 8082 with env from `.env`.
- `npm run android` / `npm run ios` — start Expo targeting Android/iOS simulators.
- `npm test` — run Jest (uses `jest-expo` for React Native).
- `npx jest --watch` — fast local test loop.
- After installs, `patch-package` runs via `postinstall`; commit any patched files under `patches/`.

## Coding Style & Naming Conventions
- Language: TypeScript/React Native; prefer functional components and hooks.
- Imports: use absolute module resolver paths when available; group React/React Native first, then project modules.
- Naming: components in `PascalCase`, hooks `useCamelCase`, files `kebab-case.ts[x]`.
- Formatting: aim for 2-space indentation, single quotes, trailing commas; keep functions small and pure in services.
- Firebase accessors live in `src/services/`; prefer typed helpers from `src/types`.

## Testing Guidelines
- Framework: Jest with `@testing-library/react-native` for UI and Firebase rules tests via `@firebase/rules-unit-testing`.
- Place new tests beside source (e.g., `deviceLinking.test.ts`) or in `tests/` mirroring the path.
- Name tests with the unit under test and behavior, e.g., `deviceConfig saves RTDB and Firestore`.
- Keep tests deterministic; mock network/Firebase where practical; update snapshots only when intended.

## Commit & Pull Request Guidelines
- Commits: use concise, imperative subjects (`Fix caregiver unlink auth`), group related changes; include patches generated by `patch-package`.
- Pull Requests: provide a short summary, link to issue/task, list test commands run, and attach screenshots for UI changes (mobile views if applicable).
- Call out risk areas (auth, Firebase writes, device actions) and any manual steps required (`expo prebuild`, env vars).

## Security & Configuration Tips
- Do not commit secrets; `.env` holds local config for Expo/Firebase. Keep `.firebaserc` and rules in sync with changes.
- When touching Firebase rules or callable usage, run relevant rule tests in `tests/` and document required indexes if needed.
